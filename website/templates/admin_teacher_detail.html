<!DOCTYPE html>
<html>
<head>
    <title>{{ teacher.name }} ‚Äî Admin ‚Äî CozmicLearning</title>
    <link rel="stylesheet" href="/static/style.css?v=20251202">
    <style>
        body { margin: 0; padding: 0; background: var(--bg-gradient-main); font-family: "Poppins", sans-serif; color: white; }
        .stars { position: fixed; inset: 0; background: url('/static/stars.png'); background-size: cover; opacity: 0.25; z-index: -1; animation: drift 65s linear infinite; }
        @keyframes drift { from { transform: translateY(0); } to { transform: translateY(-2200px); } }

        .sidebar { width: 260px; height: 100vh; background: rgba(0,0,0,0.45); backdrop-filter: blur(14px); border-right: 1px solid rgba(255,255,255,0.12); position: fixed; top: 0; left: 0; padding: 30px 20px; }
        .sidebar h2 { margin: 0 0 40px; font-size: 1.7rem; text-align: center; color: #bfe6ff; text-shadow: 0 0 12px rgba(255,255,255,0.4); }
        .nav-link { display: block; padding: 14px 18px; border-radius: 12px; color: white; margin-bottom: 12px; text-decoration: none; background: rgba(255,255,255,0.05); transition: 0.25s; }
        .nav-link:hover { background: rgba(255,255,255,0.15); transform: translateX(4px); }
        .logout { margin-top: 40px; background: rgba(255,100,100,0.25); }

        .main { margin-left: 280px; padding: 40px; height: calc(100vh - 80px); overflow-y: auto; }
        .page-title { font-size: 2.3rem; margin-bottom: 15px; color: #cfe8ff; }
        .back-link { color: var(--accent); text-decoration: none; font-size: 0.9rem; }

        .info-card { background: rgba(255,255,255,0.07); padding: 20px; border-radius: 14px; margin-bottom: 20px; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .info-label { font-size: 0.85rem; opacity: 0.7; margin-bottom: 4px; }
        .info-value { font-size: 1.1rem; font-weight: 500; }

        .section-title { font-size: 1.5rem; margin: 30px 0 15px; color: #cfe8ff; }
        .class-card { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; margin-bottom: 12px; }
        table { width: 100%; background: rgba(255,255,255,0.05); border-radius: 14px; overflow: hidden; margin-bottom: 20px; }
        th { background: rgba(255,255,255,0.1); padding: 12px; text-align: left; font-size: 0.9rem; }
        td { padding: 10px 12px; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 0.9rem; }
    </style>
</head>
<body>
<div class="stars"></div>

<div class="sidebar">
    <h2>Admin Panel</h2>
    <a class="nav-link" href="/admin">üìä Dashboard</a>
    <a class="nav-link" href="/admin/students">üë• Students</a>
    <a class="nav-link" href="/admin/teachers">üë®‚Äçüè´ Teachers</a>
    <a class="nav-link" href="/admin/parents">üë™ Parents</a>
    <a class="nav-link" href="/admin/assignments">üìù Assignments</a>
    <a class="nav-link" href="/admin/moderation">üõ°Ô∏è Content Moderation</a>
    <a class="nav-link logout" href="/admin_logout">Log Out</a>
</div>

<div class="main">
    <a href="/admin/teachers" class="back-link">‚Üê Back to Teachers</a>
    <div class="page-title">{{ teacher.name }}</div>

    <!-- Teacher Info -->
    <div class="info-card">
        <div class="info-grid">
            <div class="info-item">
                <div class="info-label">Email</div>
                <div class="info-value">{{ teacher.email }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Plan</div>
                <div class="info-value">{{ teacher.plan or 'free' }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Status</div>
                <div class="info-value">{{ 'Active' if teacher.subscription_active else 'Inactive' }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Total Students</div>
                <div class="info-value">{{ total_students }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Classes</div>
                <div class="info-value">{{ classes|length }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Assignments Created</div>
                <div class="info-value">{{ assignments|length }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Joined</div>
                <div class="info-value">{{ teacher.created_at.strftime('%Y-%m-%d') if teacher.created_at else 'N/A' }}</div>
            </div>
        </div>
    </div>

    <!-- Classes -->
    <div class="section-title">Classes ({{ classes|length }})</div>
    {% for cls in classes %}
    <div class="class-card">
        <strong>{{ cls.class_name }}</strong> ‚Äî Grade {{ cls.grade_level or 'N/A' }}
        <span style="opacity: 0.7; font-size: 0.9rem; margin-left: 10px;">({{ cls.students|length if cls.students else 0 }} students)</span>
    </div>
    {% else %}
    <div style="opacity: 0.6; padding: 20px;">No classes yet</div>
    {% endfor %}

    <!-- Recent Assignments -->
    <div class="section-title">Recent Assignments (Last 20)</div>
    <table>
        <thead>
            <tr>
                <th>Title</th>
                <th>Class</th>
                <th>Subject</th>
                <th>Due Date</th>
                <th>Created</th>
            </tr>
        </thead>
        <tbody>
            {% for a in assignments %}
            <tr>
                <td><strong>{{ a.title }}</strong></td>
                <td>{{ a.class_ref.class_name if a.class_ref else 'N/A' }}</td>
                <td>{{ a.subject }}</td>
                <td>{{ a.due_date.strftime('%Y-%m-%d') if a.due_date else 'No deadline' }}</td>
                <td>{{ a.created_at.strftime('%Y-%m-%d') if a.created_at else 'N/A' }}</td>
            </tr>
            {% else %}
            <tr><td colspan="5" style="text-align: center; padding: 30px;">No assignments yet</td></tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Lesson Plans -->
    <div class="section-title">Recent Lesson Plans (Last 10)</div>
    <table>
        <thead>
            <tr>
                <th>Topic</th>
                <th>Subject</th>
                <th>Grade</th>
                <th>Created</th>
            </tr>
        </thead>
        <tbody>
            {% for lp in lesson_plans %}
            <tr>
                <td>{{ lp.topic }}</td>
                <td>{{ lp.subject }}</td>
                <td>{{ lp.grade }}</td>
                <td>{{ lp.created_at.strftime('%Y-%m-%d') if lp.created_at else 'N/A' }}</td>
            </tr>
            {% else %}
            <tr><td colspan="4" style="text-align: center; padding: 30px;">No lesson plans yet</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>

</body>
</html>
