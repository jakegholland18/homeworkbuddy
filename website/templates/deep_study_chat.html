{% extends "layout.html" %}
{% block content %}

<style>
.chat-container {
    width: 70%;
    max-width: 1000px;
    margin: 50px auto;
    background: #102038;
    border-radius: 20px;
    padding: 25px;
    color: white;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
}

.messages {
    height: 500px;
    overflow-y: auto;
    padding-right: 10px;
}

.msg {
    margin: 15px 0;
    padding: 12px 16px;
    border-radius: 12px;
    max-width: 80%;
}

.user-msg {
    background: #4b75ff;
    margin-left: auto;
    color: white;
}

.ai-msg {
    background: #1a2d47;
    border-left: 4px solid #88b0ff;
}

#chatInput {
    width: 100%;
    padding: 14px;
    border-radius: 12px;
    border: none;
    margin-top: 10px;
    font-size: 1.1rem;
}
</style>

<div class="chat-container fade-in">

    <h2 style="text-align:center;">âš¡ Deep Study Tutor</h2>

    <div id="messages" class="messages"></div>

    <input id="chatInput" placeholder="Ask anything... press Enter to send">
</div>

<script>
const messagesDiv = document.getElementById("messages");
const input = document.getElementById("chatInput");

function addMessage(text, isUser) {
    const div = document.createElement("div");
    div.className = "msg " + (isUser ? "user-msg" : "ai-msg");
    div.textContent = text;
    messagesDiv.appendChild(div);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

input.addEventListener("keydown", async (e) => {
    if (e.key === "Enter" && input.value.trim() !== "") {
        const text = input.value;
        addMessage(text, true);
        input.value = "";

        const res = await fetch("/deep_study_message", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ message: text })
        });

        const data = await res.json();
        addMessage(data.reply, false);
    }
});
</script>

{% endblock %}



